<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Setup | KaryaSetu</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1b2e 0%, #0f0f0f 100%);
            color: #fff;
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 700px;
            margin: 0 auto;
            background: rgba(30, 32, 58, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 2rem;
        }

        h1 {
            background: linear-gradient(135deg, #00d2ff, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
            text-align: center;
        }

        .section {
            margin: 2rem 0;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
        }

        .section h2 {
            color: #00d2ff;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .input-group {
            margin: 1rem 0;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            opacity: 0.9;
            font-size: 0.95rem;
        }

        input {
            width: 100%;
            padding: 0.8rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            font-size: 1rem;
        }

        .btn {
            background: linear-gradient(135deg, #00d2ff, #a855f7);
            color: #fff;
            border: none;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 1rem;
        }

        .btn:hover {
            transform: scale(1.02);
        }

        .url-display {
            background: rgba(0, 0, 0, 0.4);
            padding: 1rem;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 1rem 0;
            border: 1px solid rgba(0, 255, 136, 0.3);
            word-break: break-all;
        }

        .alert {
            background: rgba(255, 206, 0, 0.2);
            border: 1px solid rgba(255, 206, 0, 0.5);
            color: #ffce00;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .success {
            background: rgba(0, 255, 136, 0.2);
            border: 1px solid rgba(0, 255, 136, 0.5);
            color: #00ff88;
        }

        .step {
            margin: 1rem 0;
            padding-left: 1.5rem;
            border-left: 3px solid #00d2ff;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üåê Network Setup for GPS Testing</h1>

        <div class="section">
            <h2>Step 1: Enter Your IP Address</h2>
            <p style="margin-bottom: 1rem; opacity: 0.8;">
                Run <code>ipconfig</code> in terminal and enter your IPv4 address:
            </p>

            <div class="input-group">
                <label>Your Computer's IP Address:</label>
                <input type="text" id="ip-address" placeholder="e.g., 192.168.1.105" value="192.168.">
            </div>

            <button class="btn" onclick="generateUrls()">Generate URLs</button>
        </div>

        <div class="section" id="urls-section" style="display: none;">
            <h2>Step 2: Share These URLs</h2>

            <div style="margin: 1.5rem 0;">
                <strong style="color: #00ff88;">For You (Customer - Track Friend):</strong>
                <div class="url-display" id="customer-url">-</div>
                <button class="btn" onclick="openUrl('customer-url')">Open on This Device</button>
            </div>

            <div style="margin: 1.5rem 0;">
                <strong style="color: #00ff88;">For Your Friend (Worker - Share Location):</strong>
                <div class="url-display" id="worker-url">-</div>
                <button class="btn" onclick="copyUrl('worker-url')">Copy & Send to Friend</button>
            </div>

            <div class="alert success">
                ‚úì Make sure both devices are connected to the <strong>same WiFi network</strong>!
            </div>
        </div>

        <div class="section">
            <h2>Step 3: Test Connection</h2>

            <div class="step">
                <h3 style="font-size: 1rem; margin-bottom: 0.5rem;">On Your Device:</h3>
                <p style="opacity: 0.8;">Open the Customer URL above and click "Get My Location"</p>
            </div>

            <div class="step">
                <h3 style="font-size: 1rem; margin-bottom: 0.5rem;">On Friend's Device:</h3>
                <p style="opacity: 0.8;">Send them the Worker URL. They open it and toggle "Share Location" ON</p>
            </div>

            <div class="alert">
                ‚ö†Ô∏è If it doesn't work, check Windows Firewall and allow ports 3000 and 5000
            </div>
        </div>
    </div>

    <script>
        const bookingId = 'network-test-' + Date.now();

        function generateUrls() {
            const ip = document.getElementById('ip-address').value.trim();

            if (!ip || !ip.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/)) {
                alert('Please enter a valid IP address (e.g., 192.168.1.105)');
                return;
            }

            const customerUrl = `http://${ip}:3000/tracking/live-customer.html?bookingId=${bookingId}`;
            const workerUrl = `http://${ip}:3000/tracking/live-worker.html?bookingId=${bookingId}`;

            document.getElementById('customer-url').textContent = customerUrl;
            document.getElementById('worker-url').textContent = workerUrl;
            document.getElementById('urls-section').style.display = 'block';

            // Store for later use
            localStorage.setItem('networkIP', ip);
            localStorage.setItem('bookingId', bookingId);
        }

        function openUrl(elementId) {
            const url = document.getElementById(elementId).textContent;
            window.open(url, '_blank');
        }

        function copyUrl(elementId) {
            const url = document.getElementById(elementId).textContent;
            navigator.clipboard.writeText(url).then(() => {
                alert('‚úì URL copied! Send it to your friend via WhatsApp/SMS');
            });
        }

        // Auto-load saved IP
        const savedIP = localStorage.getItem('networkIP');
        if (savedIP) {
            document.getElementById('ip-address').value = savedIP;
        }
    </script>
</body>

</html>